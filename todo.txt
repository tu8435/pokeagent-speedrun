Ok we need to have a flag that turns on/off NPCs in the state. We also need to make note of any NPCs that are blocking doors or have any other terrain underneath them. Then we need to make the disclaimer in the state prompt that these are static NPC positions and that they may have moved from their original position.

Next, we need to make sure we are only regarding valid dialogue. THe dialogue may be from a previous encounter. We should use OCR or something to check if there is dialogue on the frame in the lower half of the frame to establish if we are in a dialogue or battle phase.

Then for battle phases, we do not want to provide the map or dialogue information. We should specifically have battling information for the encounter / trainer battle.

Also we should make sure all pytests work (and create new pytests for cleaned up scenarios along the way). Each of these directions should be completed and tested with a single pytest and a commit when they are done. Claude is not a valid co[ ]author.

TODO:
[ ] make sure battle states are correct
[âœ“] Remove old agent.py, server.app and just keep agent_direct.py (rename to agent.py)
[ ] uv integration
[ ] m-series macbook mgba instructions (how can i test this platform from ubuntu?)